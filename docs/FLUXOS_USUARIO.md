# ğŸ”„ Fluxos de UsuÃ¡rio

## VisÃ£o Geral

DocumentaÃ§Ã£o dos principais fluxos de interaÃ§Ã£o do usuÃ¡rio com o sistema.

---

## 1. Fluxo de Login

### SequÃªncia

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ UsuÃ¡rio â”‚         â”‚  Login   â”‚         â”‚   Auth   â”‚         â”‚ Backend  â”‚
â”‚         â”‚         â”‚   Page   â”‚         â”‚  Context â”‚         â”‚   API    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚                    â”‚                    â”‚                    â”‚
     â”‚ 1. Acessa /login   â”‚                    â”‚                    â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                    â”‚                    â”‚
     â”‚                    â”‚                    â”‚                    â”‚
     â”‚ 2. Preenche form   â”‚                    â”‚                    â”‚
     â”‚    email + senha   â”‚                    â”‚                    â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                    â”‚                    â”‚
     â”‚                    â”‚                    â”‚                    â”‚
     â”‚ 3. Clica "Entrar"  â”‚                    â”‚                    â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                    â”‚                    â”‚
     â”‚                    â”‚                    â”‚                    â”‚
     â”‚                    â”‚ 4. login(email,pwd)â”‚                    â”‚
     â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                    â”‚
     â”‚                    â”‚                    â”‚                    â”‚
     â”‚                    â”‚                    â”‚ 5. POST /auth/loginâ”‚
     â”‚                    â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
     â”‚                    â”‚                    â”‚                    â”‚
     â”‚                    â”‚                    â”‚ 6. Valida          â”‚
     â”‚                    â”‚                    â”‚    credentials     â”‚
     â”‚                    â”‚                    â”‚                    â”‚
     â”‚                    â”‚                    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                    â”‚                    â”‚ 7. Returns tokens  â”‚
     â”‚                    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
     â”‚                    â”‚ 8. Success         â”‚                    â”‚
     â”‚                    â”‚                    â”‚                    â”‚
     â”‚                    â”‚ 9. Save tokens     â”‚                    â”‚
     â”‚                    â”‚    localStorage    â”‚                    â”‚
     â”‚                    â”‚                    â”‚                    â”‚
     â”‚                    â”‚ 10. Fetch user infoâ”‚                    â”‚
     â”‚                    â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
     â”‚                    â”‚                    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                    â”‚                    â”‚                    â”‚
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 11. Navigate("/")  â”‚                    â”‚
     â”‚ Redireciona Home   â”‚                    â”‚                    â”‚
     â”‚                    â”‚                    â”‚                    â”‚
```

### CÃ³digo

```typescript
// Login.tsx
const handleLogin = async (e: React.FormEvent) => {
  e.preventDefault();
  setLoading(true);
  
  try {
    const success = await login(email, password);
    
    if (success) {
      notifications.show({
        title: 'Sucesso',
        message: 'Login realizado com sucesso',
        color: 'green'
      });
      navigate('/');
    }
  } catch (error) {
    notifications.show({
      title: 'Erro',
      message: 'Credenciais invÃ¡lidas',
      color: 'red'
    });
  } finally {
    setLoading(false);
  }
};
```

---

## 2. Fluxo de Registro de OcorrÃªncia

### Parte 1: Dados BÃ¡sicos

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Bombeiro â”‚         â”‚   Registro   â”‚         â”‚  Occurrence  â”‚         â”‚ Backend  â”‚
â”‚         â”‚         â”‚  Ocorrencia  â”‚         â”‚   Service    â”‚         â”‚   API    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚ 1. Acessa rota      â”‚                        â”‚                       â”‚
     â”‚    /RegistroOcorrencia                       â”‚                       â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚ 2. Preenche form    â”‚                        â”‚                       â”‚
     â”‚    - Nome solicitante                        â”‚                       â”‚
     â”‚    - Telefone       â”‚                        â”‚                       â”‚
     â”‚    - Tem vÃ­timas?   â”‚                        â”‚                       â”‚
     â”‚    - Tipo ocorrÃªnciaâ”‚                        â”‚                       â”‚
     â”‚    - EndereÃ§o       â”‚                        â”‚                       â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚ 3. Clica "Registrar"â”‚                        â”‚                       â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                        â”‚                       â”‚
     â”‚                     â”‚ 4. Valida form         â”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚ 5. createOccurrence()  â”‚                       â”‚
     â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚ 6. POST /occurrences  â”‚
     â”‚                     â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚ 7. Cria occurrence    â”‚
     â”‚                     â”‚                        â”‚    Status: EM_ATENDIMENTO
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 8. Returns ID         â”‚
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 9. NotificaÃ§Ã£o sucesso â”‚                       â”‚
     â”‚ Redireciona /Ocorrencia                      â”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
```

### Parte 2: ConclusÃ£o da OcorrÃªncia

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Bombeiro â”‚         â”‚  Completar   â”‚         â”‚  Occurrence  â”‚         â”‚ Backend  â”‚
â”‚         â”‚         â”‚  Ocorrencia  â”‚         â”‚   Service    â”‚         â”‚   API    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚ 1. ApÃ³s atendimento â”‚                        â”‚                       â”‚
     â”‚    acessa rota      â”‚                        â”‚                       â”‚
     â”‚    /CompletarOcorrencia                      â”‚                       â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚ 2. Preenche dados   â”‚                        â”‚                       â”‚
     â”‚    - Detalhes       â”‚                        â”‚                       â”‚
     â”‚    - Lat/Long       â”‚                        â”‚                       â”‚
     â”‚    - Hora chegada   â”‚                        â”‚                       â”‚
     â”‚    - Bombeiros      â”‚                        â”‚                       â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚ 3. Clica "Finalizar"â”‚                        â”‚                       â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚ 4. completeOccurrence()â”‚                       â”‚
     â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚ 5. PUT /complete/{id} â”‚
     â”‚                     â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚ 6. Atualiza           â”‚
     â”‚                     â”‚                        â”‚    Status: CONCLUIDA  â”‚
     â”‚                     â”‚                        â”‚    + dados finais     â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 7. Success            â”‚
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 8. NotificaÃ§Ã£o         â”‚                       â”‚
     â”‚ Redireciona /Ocorrencia                      â”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
```

### CÃ³digo

```typescript
// RegistroOcorrencia.tsx
const handleSubmit = async (values: OccurrenceFormValues) => {
  try {
    await createOccurrence({
      occurrenceHasVictims: values.hasVictims,
      occurrenceRequester: values.requester,
      occurrenceRequesterPhoneNumber: values.phoneNumber,
      occurrenceSubType: values.subType,
      address: values.address
    });
    
    notifications.show({
      title: 'Sucesso',
      message: 'OcorrÃªncia registrada',
      color: 'green'
    });
    
    navigate('/Ocorrencia');
  } catch (error) {
    notifications.show({
      title: 'Erro',
      message: 'Falha ao registrar ocorrÃªncia',
      color: 'red'
    });
  }
};
```

---

## 3. Fluxo de Cadastro de UsuÃ¡rio

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Admin  â”‚         â”‚   Cadastro   â”‚         â”‚     User     â”‚         â”‚ Backend  â”‚
â”‚         â”‚         â”‚   Usuario    â”‚         â”‚   Service    â”‚         â”‚   API    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚ 1. Acessa           â”‚                        â”‚                       â”‚
     â”‚    /administracao/CadastroUsuario            â”‚                       â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚ 2. Preenche form    â”‚                        â”‚                       â”‚
     â”‚    - Dados pessoais â”‚                        â”‚                       â”‚
     â”‚    - Username/Email â”‚                        â”‚                       â”‚
     â”‚    - CPF/MatrÃ­cula  â”‚                        â”‚                       â”‚
     â”‚    - Patente        â”‚                        â”‚                       â”‚
     â”‚    - BatalhÃ£o       â”‚                        â”‚                       â”‚
     â”‚    - EndereÃ§o       â”‚                        â”‚                       â”‚
     â”‚    - Senha          â”‚                        â”‚                       â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚ 3. Clica "Cadastrar"â”‚                        â”‚                       â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                        â”‚                       â”‚
     â”‚                     â”‚ 4. Valida campos       â”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚ 5. createUser()        â”‚                       â”‚
     â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚ 6. POST /auth/created/user
     â”‚                     â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚ 7. Valida unique:     â”‚
     â”‚                     â”‚                        â”‚    CPF, email, username
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚ 8. Hash password      â”‚
     â”‚                     â”‚                        â”‚    (BCrypt)           â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚ 9. Cria user          â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 10. Success           â”‚
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 11. NotificaÃ§Ã£o        â”‚                       â”‚
     â”‚ Redireciona /administracao/Users             â”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
```

---

## 4. Fluxo de Listagem com PaginaÃ§Ã£o

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚UsuÃ¡rio  â”‚         â”‚  Ocorrencia  â”‚         â”‚  Occurrence  â”‚         â”‚ Backend  â”‚
â”‚         â”‚         â”‚     Page     â”‚         â”‚   Service    â”‚         â”‚   API    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚ 1. Acessa /Ocorrencia                        â”‚                       â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚ 2. useEffect mounts    â”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚ 3. getOccurrencesPaginated()                   â”‚
     â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                       â”‚
     â”‚                     â”‚    (page=1, size=10)   â”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚ 4. GET /occurrences/  â”‚
     â”‚                     â”‚                        â”‚    paginator?page=1   â”‚
     â”‚                     â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚ 5. Query DB           â”‚
     â”‚                     â”‚                        â”‚    LIMIT/OFFSET       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 6. Returns            â”‚
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 7. Renderiza tabela    â”‚    {items, total,     â”‚
     â”‚ Exibe dados         â”‚                        â”‚     pages}            â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚ 8. Clica prÃ³xima    â”‚                        â”‚                       â”‚
     â”‚    pÃ¡gina           â”‚                        â”‚                       â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                        â”‚                       â”‚
     â”‚                     â”‚ 9. getOccurrencesPaginated()                   â”‚
     â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                       â”‚
     â”‚                     â”‚    (page=2, size=10)   â”‚                       â”‚
     â”‚                     â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
     â”‚                     â”‚                        â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                       â”‚
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ Atualiza tabela        â”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
```

### CÃ³digo

```typescript
// Ocorrencia.tsx
const [occurrences, setOccurrences] = useState([]);
const [page, setPage] = useState(1);
const [totalPages, setTotalPages] = useState(1);
const [loading, setLoading] = useState(false);

useEffect(() => {
  loadOccurrences();
}, [page]);

const loadOccurrences = async () => {
  setLoading(true);
  try {
    const data = await getOccurrencesPaginated(page, 10);
    setOccurrences(data.items);
    setTotalPages(data.totalPages);
  } catch (error) {
    notifications.show({
      title: 'Erro',
      message: 'Falha ao carregar ocorrÃªncias',
      color: 'red'
    });
  } finally {
    setLoading(false);
  }
};
```

---

## 5. Fluxo de Refresh Token AutomÃ¡tico

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚UsuÃ¡rio  â”‚         â”‚   Axios      â”‚         â”‚     Auth     â”‚         â”‚ Backend  â”‚
â”‚         â”‚         â”‚ Interceptor  â”‚         â”‚   Context    â”‚         â”‚   API    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚ 1. Faz requisiÃ§Ã£o   â”‚                        â”‚                       â”‚
     â”‚    (token expirado) â”‚                        â”‚                       â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                        â”‚                       â”‚
     â”‚                     â”‚ 2. Request com token   â”‚                       â”‚
     â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚ 3. Valida token       â”‚
     â”‚                     â”‚                        â”‚    Expirado!          â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                     â”‚ 4. 401 Unauthorized    â”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚ 5. Detecta 401         â”‚                       â”‚
     â”‚                     â”‚    !_retry             â”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚ 6. refreshAccessToken()â”‚                       â”‚
     â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚ 7. POST /auth/        â”‚
     â”‚                     â”‚                        â”‚    refresh-token/     â”‚
     â”‚                     â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚ 8. Valida refresh     â”‚
     â”‚                     â”‚                        â”‚    token              â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 9. New access token   â”‚
     â”‚                     â”‚ 10. Save new token     â”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚ 11. Retry original     â”‚                       â”‚
     â”‚                     â”‚     request with new   â”‚                       â”‚
     â”‚                     â”‚     token              â”‚                       â”‚
     â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 12. Success            â”‚                       â”‚
     â”‚ Recebe dados        â”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
```

---

## 6. Fluxo de Busca/Filtro

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚UsuÃ¡rio  â”‚         â”‚  Users Page  â”‚         â”‚     Auth     â”‚         â”‚ Backend  â”‚
â”‚         â”‚         â”‚              â”‚         â”‚   Service    â”‚         â”‚   API    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚ 1. Digita no campo  â”‚                        â”‚                       â”‚
     â”‚    de busca: "joÃ£o" â”‚                        â”‚                       â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                        â”‚                       â”‚
     â”‚                     â”‚ 2. Debounce 500ms      â”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚ 3. getUsersPaginated() â”‚                       â”‚
     â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                       â”‚
     â”‚                     â”‚    (filter="joÃ£o")     â”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚ 4. GET /auth/         â”‚
     â”‚                     â”‚                        â”‚    paginator?         â”‚
     â”‚                     â”‚                        â”‚    filterGeneric=joÃ£o â”‚
     â”‚                     â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚ 5. Query:             â”‚
     â”‚                     â”‚                        â”‚    WHERE name LIKE    â”‚
     â”‚                     â”‚                        â”‚    '%joÃ£o%'           â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 6. Filtered results   â”‚
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 7. Atualiza tabela     â”‚                       â”‚
     â”‚ Exibe resultados    â”‚                        â”‚                       â”‚
     â”‚ filtrados           â”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
```

### CÃ³digo

```typescript
// Users.tsx
const [filter, setFilter] = useState('');
const [debouncedFilter] = useDebouncedValue(filter, 500);

useEffect(() => {
  loadUsers();
}, [page, debouncedFilter]);

const loadUsers = async () => {
  setLoading(true);
  try {
    const data = await getUsersPaginated(
      page,
      10,
      debouncedFilter,
      true
    );
    setUsers(data.items);
  } finally {
    setLoading(false);
  }
};
```

---

## 7. Fluxo de Logout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚UsuÃ¡rio  â”‚         â”‚    NavBar    â”‚         â”‚     Auth     â”‚         â”‚ Backend  â”‚
â”‚         â”‚         â”‚              â”‚         â”‚   Context    â”‚         â”‚   API    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚ 1. Clica "Sair"     â”‚                        â”‚                       â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                        â”‚                       â”‚
     â”‚                     â”‚ 2. logout()            â”‚                       â”‚
     â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚ 3. POST /auth/        â”‚
     â”‚                     â”‚                        â”‚    logout/{id}        â”‚
     â”‚                     â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚ 4. Limpa refresh      â”‚
     â”‚                     â”‚                        â”‚    token do banco     â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 5. Success            â”‚
     â”‚                     â”‚ 6. Clear localStorage  â”‚                       â”‚
     â”‚                     â”‚    - accessToken       â”‚                       â”‚
     â”‚                     â”‚    - refreshToken      â”‚                       â”‚
     â”‚                     â”‚    - userId            â”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚ 7. Reset state         â”‚                       â”‚
     â”‚                     â”‚    - isAuthenticated=false                     â”‚
     â”‚                     â”‚    - user=null         â”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 8. Navigate("/login")  â”‚                       â”‚
     â”‚ Redireciona login   â”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
```

---

## 8. Fluxo PWA (Offline)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚UsuÃ¡rio  â”‚         â”‚   Browser    â”‚         â”‚   Service    â”‚         â”‚  Cache   â”‚
â”‚         â”‚         â”‚              â”‚         â”‚   Worker     â”‚         â”‚          â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚ 1. Acessa app       â”‚                        â”‚                       â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                        â”‚                       â”‚
     â”‚                     â”‚ 2. Check SW            â”‚                       â”‚
     â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 3. SW ativo           â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚ 4. Faz requisiÃ§Ã£o   â”‚                        â”‚                       â”‚
     â”‚    (offline)        â”‚                        â”‚                       â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                        â”‚                       â”‚
     â”‚                     â”‚ 5. Intercept request   â”‚                       â”‚
     â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚ 6. Check cache        â”‚
     â”‚                     â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
     â”‚                     â”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 7. Cached response    â”‚
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 8. Retorna dados       â”‚                       â”‚
     â”‚ Exibe dados cached  â”‚                        â”‚                       â”‚
     â”‚                     â”‚                        â”‚                       â”‚
```

---

## ConclusÃ£o

Os fluxos foram projetados para:

âœ… **ExperiÃªncia fluida** - TransiÃ§Ãµes suaves  
âœ… **Feedback visual** - NotificaÃ§Ãµes e loading  
âœ… **Tratamento de erros** - Mensagens claras  
âœ… **Performance** - OtimizaÃ§Ãµes e cache  
âœ… **SeguranÃ§a** - Tokens e validaÃ§Ãµes  
âœ… **Offline-first** - PWA com cache
